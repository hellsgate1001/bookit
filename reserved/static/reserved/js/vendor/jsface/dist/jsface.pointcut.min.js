/*
 * JSFace Object Oriented Programming Library.
 * Copyright (c) 2009-2013 Tan Nhu, http://lnkd.in/tnhu
 */
!function(a){function b(a,b,c,d){function e(){for(var a,b,c=e[k],d=c.length,f=e[l],g=f.length,h=e[m];d--;)if(b=c[d].apply(this,arguments),i(b)&&b.$skip===!0)return b.$data;for(a=h.apply(this,arguments);g--;)if(b=f[g].apply(this,arguments),i(b)&&b.$skip===!0)return a;return a}return a[j]===a?(a[k].push(b),a[l].push(c),a[n].push(d),a):(h(e,a,0,!0),f(a)&&(e.prototype=a.prototype),e[k]=[b],e[l]=[c],e[m]=a,e[n]=[d],e[j]=e,e.$super=a.$super,e.$superp=a.$superp,e)}function c(a,b){var d,e,f;if(a&&a===a[j])if(b){for(e=f=a[n].length;e--&&a[n][e]!==b;);if(e>=0){if(1===f)return c(a);a[n].splice(e,1),a[k].splice(e,1),a[l].splice(e,1)}}else d=a[m],delete a[m],delete a[n],delete a[k],delete a[l],delete a[j];return d}function d(a,b,d,e,f,g){function h(b,d){var f,h,j,k,l;for(f in b)h=f/1==f?b[f]:f,j="constructor"===h,k=e&&g[h]===a[h],l=c(j&&e&&a||g[h],d),i=i||j&&l,l&&!j&&(g[h]=l,k&&(a[h]=l))}var i,k,l,n;if("remove"===b)if(d)h(d,d);else{i=e&&a===a[j]&&a[m];for(var p in g){var n=g[p],q=e&&g[p]===a[p];g[p]=c(n)||g[p],q&&(a[p]=g[p])}}else{if(null===(k=/^remove /.exec(b)))throw o+"params";l=b.replace(k,"").split(" "),h(l)}return i||a}var e=a.jsface||require("./jsface"),f=(e.Class,e.classOrNil),g=e.functionOrNil,h=e.extend,i=e.mapOrNil,j="___wrapper___",k="___before_fns___",l="___after_fns___",m="___origin_fn___",n="___advisors___",o="Invalid ",p="Non-function property named ",q=function(){};e.pointcut=function(a,c){var e,f,h,j=g(a),k=i(a),l=null!==/^remove ?/.exec(c),m=l&&arguments[2];if(!j&&!k||!i(c)&&!l)throw o+"params";if(e=j?a.prototype:a,l)return d(a,c,m,j,k,e);for(f in c){h=c[f],h=g(h)?{before:h}:h;var n,r=i(h)&&!h.before?q:h.before,s=i(h)&&!h.after?q:h.after;if(!g(r))throw o+f+":before";if(!g(s))throw o+f+":after";if(k){if(!g(e[f]))throw p+f;e[f]=b(e[f],r,s,c)}else if("constructor"===f)a=b(a,r,s,c);else{if(!g(e[f]))throw p+f;n=j&&e[f]===a[f],e[f]=b(e[f],r,s,c),n&&(a[f]=e[f])}}return a},"undefined"!=typeof module&&module.exports&&(module.exports=e.pointcut)}(this);